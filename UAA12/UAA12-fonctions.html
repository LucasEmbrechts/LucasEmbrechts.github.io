<!DOCTYPE html>
<html>
  <head>
    <title>Title</title>
    <meta charset="utf-8">
    <style>
      @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body { font-family: 'Droid Serif'; }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: normal;
      }
      .remark-code, .remark-inline-code { font-family: 'Consolas'; }
			  @page {
		  size: 1210px 681px;
		  margin: 0;
		}

		@media print {
		  .remark-slide-scaler {
			width: 100% !important;
			height: 100% !important;
			transform: scale(1) !important;
			top: 0 !important;
			left: 0 !important;
		  }
		}
    small{
      font-size: 10px!important;
    }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
  </head>
  <body>
    <textarea id="source">

class: center, middle

# Développement d’un site web dynamique :
# les fonctions
<img height="200px" src="img/php.png">

---
## On parle de quoi ?
1. <a href="UAA12-fonctions.html#3">Déclaration d'une fonction</a>
2. <a href="UAA12-fonctions.html#4">Appel d'une fonction</a>
3. <a href="UAA12-fonctions.html#5">Portée d'une fonction</a>
4. <a href="UAA12-fonctions.html#6">Fonction avec valeur par défaut</a>
5. <a href="UAA12-fonctions.html#7">Fonction qui renvoient plusieurs valeurs</a>
6. <a href="UAA12-fonctions.html#8">Variables locales et globales</a>
7. <a href="UAA12-fonctions.html#13">Variables superglobales</a>

---
## Déclaration d'une fonction

La syntaxe est similaire au JavaScript...

```php
function maFonction ($arg1, $arg2,...){
  // code
  return ...
}
```
---
## Appel d'une fonction

La syntaxe est similaire au JavaScript...

```php
maFonction($x, $y,...);
// ou
$z = maFonction($x, $y,...);
```

---
## Portée (scope) d'une fonction

Comme en JavaScript, PHP lit toutes les définitions de fonctions avant de commencer l'exécution : on peut donc utiliser une fonction définie plus bas.

```php
carre(4);
function carre($x){
  echo $x * $x;
}
```
---
## Fonction avec valeur par défaut

En PHP, on peut spécifier une valeur par défaut pour les arguments d'une fonction.

<span style="color: red;">Attention, il doit s'agir des derniers arguments dans la liste !</span>

```PHP
function exposant($n, $exp = 1){
  ...
}

$res = exposant(5,2); // $res = 25
$res = exposant(5);   // $res = 5
```
---
## Fonction qui renvoient plusieurs valeurs

En PHP, une fonction peut renvoyer plusieurs valeurs en les assemblant dans un tableau :

```php
function plusEtFois($x, $y){
  $somme = $x + $y;
  $produit = $x * $y;
  return array($somme, $produit);
}
```

Pour l'appel, on utilise `list` pour "retrouver" les valeurs  :

```php
list($tot, $prod) = plusEtFois(5,7);
echo "Total = $tot\n";
echo "Produit = $prod";
```
---
## Variables locales et globales

```php
$deb = 'Le résultat est ';
$fin = '.<br/>';

function calculeDouble($val){
  $d = $val * 2;
  return $d;
}

function afficheDouble($v){
  global $deb, $fin;
  $d = calculeDouble($v);
  echo $deb.$d.$fin;
}
```

* `$deb` et `$fin` sont des **variables globales** : elles sont accessibles partout
* `$d`, `$v` et `$val` sont des **variables locales** : elles sont accessibles uniquement depuis la fonction dans laquelle elles sont déclarées.
* lorsqu'on souhaite accéder à une variable globale depuis une fonction, on utilise le mot-clé `global`
---
## Exercice : quel est l'affichage ?

```php
$prix = 15;

function prixHorsSaison(){
  $prix = 10;
  echo "Le prix passe à $prix.<br/>";
}
echo "Le prix est $prix. <br/>";
prixHorsSaison();
echo "Le prix est $prix.<br/>";
```
---
## Exercice : quel est l'affichage ?

```php
$prix = 15;

function prixHorsSaison(){
  $prix = 10;
  echo "Le prix passe à $prix.<br/>";
}
echo "Le prix est $prix. <br/>";
prixHorsSaison();
echo "Le prix est $prix.<br/>";
```

```
Le prix est 15.
Le prix passe à 10.
Le prix est 15.
```
---
## Exercice : quel est l'affichage ?

```php
$prix = 15;

function prixHorsSaison(){
  global $prix;
  $prix = 10;
  echo "Le prix passe à $prix.<br/>";
}
echo "Le prix est $prix. <br/>";
prixHorsSaison();
echo "Le prix est $prix.<br/>";
```
---
## Exercice : quel est l'affichage ?

```php
$prix = 15;

function prixHorsSaison(){
  global $prix;
  $prix = 10;
  echo "Le prix passe à $prix.<br/>";
}
echo "Le prix est $prix. <br/>";
prixHorsSaison();
echo "Le prix est $prix.<br/>";
```

```
Le prix est 15.
Le prix passe à 10.
Le prix est 10.
```
---
## Variables superglobales

Les variables superglobales sont **prédéfinies** et **accessibles partout**.

* `$_SERVER` : infos provenant du serveur WEB
* `$_ENV` : infos sur l'environnement et l'OS
* `$_GET` / `$_POST` : variables reçues dans la requête HTTP
* `$_FILES` : fichiers attachés à la requête HTTP
* `$_COOKIE` : variables passées sous la forme de cookies HTTP
* `$_SESSION` : variables de session

Ces variables prennent la forme de **tableaux associatifs** (plus de détails au chapitre suivant).


    </textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create();
    </script>
  </body>
</html>